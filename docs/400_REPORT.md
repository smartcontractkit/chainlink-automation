# What is a Report?
In the context of OCR Automation, a report contains all data required to perform
one or more upkeeps per user specifications including all calldata.

## Building a Report
All nodes receive some set of observations broadcast from other nodes. A report
is generated by finding the intersection of all observations such that:

- at the intersection, the number of observations meets or exceeds the quorum
- each intersection point should be a unique upkeep
- if intersections duplicate an upkeep, the most recent `PointState` is used

Each intersection satisfying the above requirements is a `PointState` and each
`PointState` is encoded into a report. Multiple instances of `PointState` can
be added to a report, per the logic of the provided `Encoder`. A list of 
`PointState` should be shuffled (using the epoch and round as a randomness 
source) before being passed to the `Encoder`. Some items from the list may not
end up in the generated report for a single round.

### Observation Example

The following is only a case with 2 nodes, so assume a quorum requirement of 2.
Node 2 is ahead of node 3 by a single block and they also don't agree on the 
state for upkeep `89` at block `1`. Also the state differs for upkeep `90` at 
block `2` and even though there is agreement on the same upkeep at blocks `1`
and `3`, the intersection at block `3` is reported on because it is the latest.
Upkeep `89` is also reported on for block `3` because it is the latest for two
intersections on the same upkeep. Finally, `91` is also reported due to the
intersection at block `3`.

| N1-Block | N1-Upkeep | N1-Data | - | N2-Block | N2-Upkeep | N2-Data | Reported |
| :---: | :---: | --- | -- | --- | --- | --- | --- |
| 1 | 89 | xyz | - | - | - | - | |
| 1 | 90 | abc | - | 1 | 90 | abc | |
| 2 | 89 | xyz | - | 2 | 89 | xyz | |
| 2 | 90 | abc | - | 2 | 90 | abf | |
| 3 | 89 | xyz | - | 3 | 89 | xyz | * |
| 3 | 90 | abc | - | 3 | 90 | abc | * |
| 3 | 91 | lmn | - | 3 | 91 | lmn | * |
| - | - | - | - | 4 | 89 | xyz | |
| - | - | - | - | 4 | 90 | abc | |
| - | - | - | - | 4 | 91 | lmn | |

In this example, upkeeps `89`, `90`, and `91` at block `3` would be sent to the
encoder to be included in the next report. If the encoder could only fit upkeep
`89` in the next report, that upkeep would get blocked in the `accept` phase
and the next round of observations would not include `89`. Therefore, upkeeps
`90` and `91` would have another opportunity to be added to the next report.

## Pending Transmission
Once a report is generated and agreed on by an OCR Automation network of nodes,
it should be considered as pending along with all its contents. This means that
any upkeep contained in a pending report should not be included in any
observations until one of the following occurs:

- either a report log is received
- an upkeep perform log is received
- a per upkeep timeout elapses

Pending status is state that individual nodes should track to assist in making
accurate observations that other nodes will agree with. Report generation should
never interact with this state.

## Accepting a Report
A report should be accepted if all upkeeps it identifies in the report are not
pending. Once the report passes this test, all upkeeps should be marked as
pending to all observers.

## Transmitting a Report
A report should be transmitted if all the upkeeps it identifies in the report
are not pending or the report identifier is unlocked. Different version will
need to be supported. For the former, 